<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Quantum — Meeting Notes & Code</title>
  <link rel="stylesheet" href="styles.css" />
  <style>
    .wrap{max-width: min(1400px, 96vw); margin:0 auto; padding:22px}
    .top{display:flex; align-items:baseline; gap:14px; margin:6px 0 16px}
    .title{font-size:64px; line-height:1.05; margin:0}
    .count{color:var(--muted); font-size:22px}

    .summary-box {
      background: rgba(12,18,24,.58);
      border: 1px solid rgba(15,26,34,.75);
      border-radius: 16px;
      backdrop-filter: blur(8px);
      -webkit-backdrop-filter: blur(8px);
      padding: 24px 28px;
      margin-bottom: 26px;
    }
    .summary-box h2 {
      font-size: 34px;
      color: var(--amber);
      margin: 0 0 10px;
    }
    #summary-content {
      font-size: 20px;
      color: var(--muted);
      line-height: 1.6;
    }

    .grid{display:grid; grid-template-columns:1fr; gap:14px}
    @media (min-width:980px){ .grid{ grid-template-columns: 1fr 1fr } }
    .card{
      cursor:pointer;
      background:rgba(12,18,24,.58);
      border:1px solid rgba(15,26,34,.78);
      border-radius:16px; padding:20px;
      backdrop-filter: blur(8px);
      transition: transform .12s ease, background .12s ease, border-color .12s ease;
    }
    .card:hover{ transform:translateY(-2px); background:rgba(12,18,24,.66); border-color:rgba(15,26,34,.95) }
    .card h3{ margin:0 0 6px; font-size:30px; color:var(--teal) }
    .meta{ color:#d7e2ea; margin:0 0 10px; font-size:20px }
    .card p{ font-size:20px }

    /* ===== Fullscreen detail sheet ===== */
    .overlay{ position:fixed; inset:0; z-index:9999; display:none;
      background: radial-gradient(1400px 700px at 20% 0%, rgba(10,10,10,0.25), transparent 60%), rgba(5,8,12,.75);
      backdrop-filter: blur(8px);
    }
    .overlay.show{ display:block }
    .sheet{
      position:absolute; left:50%; top:50%; transform:translate(-50%,-50%);
      width: min(1200px, 96vw); height: min(94vh, 1200px);
      display:grid; grid-template-rows: auto 1fr; overflow:hidden;
      background: rgba(12,18,24,.80); border:1px solid rgba(255,255,255,.18);
      border-radius:18px; box-shadow: 0 24px 70px rgba(0,0,0,.45); color:var(--ink);
    }
    .head{ display:flex; justify-content:space-between; align-items:center;
      padding:16px 18px 10px 20px; border-bottom:1px solid rgba(255,255,255,.12)
    }
    .htitle{ font-size:34px; margin:0 }
    .hdate{ color:#cfe0ea; font-size:20px }
    .btn{ border:1px solid rgba(255,255,255,.28); background:rgba(255,255,255,.10);
      color:var(--ink); border-radius:10px; padding:8px 12px; font:18px 'VT323',monospace; cursor:pointer }
    .btn:hover{ background:rgba(255,255,255,.18) }

    .body{ overflow:auto; padding:16px; display:grid; grid-template-columns:1fr; gap:16px }
    @media (min-width:1100px){ .body{ grid-template-columns: 56% 44%; } }

    .section{
      border:1px solid rgba(255,255,255,.12);
      border-radius:14px; padding:14px;
      background: rgba(255,255,255,.06);
    }
    .section h4{ font-size:24px; color:var(--amber); margin:0 0 10px }
    .notes{ font-size:20px; line-height:1.65; white-space:pre-wrap; }
    .notes p{ margin:0 0 10px }

    .codeblock{
      position:relative; margin:0 0 14px; border:1px solid rgba(255,255,255,.16);
      background:#0b1218; border-radius:12px; overflow:hidden;
    }
    .codehead{
      display:flex; justify-content:space-between; align-items:center;
      padding:8px 12px; border-bottom:1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.05); font-size:18px; color:#dfe8ee;
    }
    .copy{ border:1px solid rgba(255,255,255,.28); background:rgba(255,255,255,.10);
      color:var(--ink); border-radius:8px; padding:4px 8px; cursor:pointer; font:16px 'VT323',monospace }
    .copy:hover{ background:rgba(255,255,255,.18) }
    pre{ margin:0; padding:14px; overflow:auto; font:16px/1.55 ui-monospace, SFMono-Regular, Menlo, Consolas, "Liberation Mono", monospace; color:#eaf1f4; }
  </style>
</head>
<body>
  <!-- Background video -->
  <video class="bg-video" autoplay muted loop playsinline preload="auto">
    <source src="assets/background_3.mp4" type="video/mp4" />
  </video>

  <header class="site-head">
    <nav class="nav">
      <a href="index.html">Home</a>
      <a href="journal.html">Journal</a>
      <a href="quantum.html" style="color:var(--amber)">Quantum</a>
    </nav>
  </header>

  <main class="wrap">
    <div class="top">
      <h1 class="title">Quantum</h1>
      <span id="count" class="count"></span>
    </div>

    <section id="summary" class="summary-box">
      <h2>Summary</h2>
      <div id="summary-content">Loading summary…</div>
    </section>

    <section id="rows" class="grid" aria-live="polite"></section>
  </main>

  <div id="ov" class="overlay" role="dialog" aria-modal="true">
    <div class="sheet">
      <div class="head">
        <div>
          <h2 id="ov-title" class="htitle">Title</h2>
          <div id="ov-date" class="hdate"></div>
        </div>
        <button id="ov-close" class="btn">✕ Close</button>
      </div>
      <div class="body">
        <div class="section">
          <h4>Summary</h4>
          <div id="ov-summary" class="notes"></div>
        </div>
        <div class="section">
          <h4>Meeting Notes</h4>
          <div id="ov-notes" class="notes"></div>
        </div>
        <div class="section">
          <h4>Code</h4>
          <div id="ov-code"></div>
        </div>
      </div>
    </div>
  </div>

  <script>
    const rowsEl=document.getElementById('rows');
    const countEl=document.getElementById('count');
    const ov=document.getElementById('ov');
    const ovTitle=document.getElementById('ov-title');
    const ovDate=document.getElementById('ov-date');
    const ovSummary=document.getElementById('ov-summary');
    const ovNotes=document.getElementById('ov-notes');
    const ovCode=document.getElementById('ov-code');
    const ovClose=document.getElementById('ov-close');
    let ALL=[];

    (async()=>{
      try{
        const r=await fetch('data/quantum.json',{cache:'no-store'});
        const d=await r.json();
        ALL=d.sort((a,b)=>new Date(b.date)-new Date(a.date));
        render(ALL);
        updateSummary(ALL);
      }catch(e){document.getElementById('summary-content').textContent='No entries yet.';}
    })();

    function updateSummary(list){
      const box=document.getElementById('summary-content');
      if(!list.length){box.textContent='No entries yet.';return;}
      const latest=list.slice(0,3);
      const text=latest.map(p=>`<p><strong>${safe(p.title)}</strong> — ${safe(p.summary||'')}</p>`).join('');
      const last=list[0].date?new Date(list[0].date).toLocaleDateString():''; 
      box.innerHTML=`<p>This is where I record my quantum meetings, notes, and discoveries.</p>${text}<p>Total entries: <strong>${list.length}</strong>${last?` • Last updated ${last}`:''}</p>`;
    }

    function render(list){
      rowsEl.innerHTML='';
      countEl.textContent=`(${list.length})`;
      list.forEach(p=>{
        const el=document.createElement('article');
        el.className='card';
        el.innerHTML=`<h3>${safe(p.title)}</h3><div class="meta">${p.date?new Date(p.date).toLocaleDateString():''}</div><p>${safe(p.summary||'')}</p>`;
        el.addEventListener('click',()=>open(p));
        rowsEl.appendChild(el);
      });
    }

    function open(p){
      ovTitle.textContent=p.title;
      ovDate.textContent=p.date?new Date(p.date).toLocaleDateString():''; 
      ovSummary.innerHTML=p.summary_long||safe(p.summary||'');
      ovNotes.textContent=p.notes||'';
      ovCode.innerHTML='';
      (p.code||[]).forEach(sn=>{
        const div=document.createElement('div');div.className='codeblock';
        div.innerHTML=`<div class="codehead"><span>${safe(sn.label||'code')}</span><button class="copy">Copy</button></div><pre><code>${safe(sn.content||'')}</code></pre>`;
        div.querySelector('.copy').addEventListener('click',()=>{
          navigator.clipboard.writeText(sn.content||'');
        });
        ovCode.appendChild(div);
      });
      ov.classList.add('show');document.body.style.overflow='hidden';
    }
    function close(){ov.classList.remove('show');document.body.style.overflow='';}
    ov.addEventListener('click',e=>{if(e.target===ov)close();});
    ovClose.addEventListener('click',close);
    window.addEventListener('keydown',e=>{if(e.key==='Escape')close();});
    function safe(s){return String(s||'').replace(/[&<>"']/g,c=>({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[c]));}
  </script>
</body>
</html>
